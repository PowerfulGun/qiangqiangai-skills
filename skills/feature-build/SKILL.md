---
name: 功能开发流程
description: 功能开发 需求拆解 任务选择 组件设计 构建循环 埋点分析 提交文档 完整生命周期 多阶段协作
author: PowerfulGun
icon: 🚀
version: "1.0"
source: https://github.com/aussiegingersnap/cursor-skills (feature-build)
---

# 功能开发流程 Skill

当用户请求开发新功能、或按完整生命周期推进需求时，按以下流程逐步执行。

## 流程概览

共 6 个阶段，可循环回溯：**任务选择 → 组件设计 → 构建循环 → 埋点/分析 → 构建验证 → 提交与文档**。任一阶段发现问题可回到前一阶段修正。

## 执行流程

### 第一步：任务选择
- 阅读项目中的 `TASKS.md`，从「当前迭代」中选取下一项未完成任务。
- 与用户确认范围：做什么、不做什么、边界情况。
- 若功能较大，拆成可在一个会话内完成的子任务，并写出可验收的**验收标准**（格式见下）。

验收标准示例：
```markdown
### 功能：[名称]
**验收标准：**
- [ ] 用户能够 [具体操作]
- [ ] 当 [条件] 时系统 [具体行为]
- [ ] 错误情况：[场景] 显示 [提示]
- [ ] 移动端：视口 < 768px 时 [行为] 正常
```

**出口条件**：范围清晰、验收标准已写且达成一致，复杂功能已拆子任务。

### 第二步：组件设计
- 先查看现有风格/组件库（如有 `/style-guide` 或 `components/ui/`），优先复用或扩展。
- 新组件在风格指南页或独立示例中设计，保证可复用、从 `components/ui/` 统一导出。
- 为每个组件展示所有状态：默认、悬停/聚焦、加载、成功、错误、禁用、空状态（若适用）。
- 考虑响应式与触控区域（最小约 44px）。

**出口条件**：组件在风格指南或示例中可见、状态齐全、已从 UI 桶文件导出，响应式已验证。

### 第三步：构建循环
- **先做后端**：数据模型/迁移 → 业务逻辑/服务层 → API 路由（建议用 Zod 校验）→ 用请求工具或浏览器网络面板验证接口。
- **再接前端**：状态管理（如 Zustand/React state）→ 请求封装与 loading/error → 把 UI 接到状态与接口。
- **浏览器内逐步验证**：打开页面 → 快照获取元素 → 点击/输入等操作 → 再次快照确认结果，必要时截图。

遇到以下情况**回到第二步**：缺状态、UI 模式不适用、需调整组件 API。  
若范围或验收标准需调整，**回到第一步**。

**出口条件**：所有验收标准在浏览器中通过，无控制台报错，错误态与移动端（若适用）已覆盖。

### 第四步：埋点与分析
- 确定需要统计的用户行为（如：表单提交、功能使用、页面浏览、付费相关尝试/升级曝光）。
- 在关键操作处添加埋点调用（如 PostHog `capture`），事件命名建议：`{功能}_{动作}`（如 `notes_created`、`upgrade_modal_shown`）。
- 若为付费/专业版功能，需配置 feature flag 与相应埋点（尝试、升级弹窗展示/点击等）。

**出口条件**：关键行为已埋点，在分析后台能见到事件，付费功能已按策略配置。

### 第五步：构建验证
- 执行 `npm run build`，必须退出码为 0；修复 TypeScript 与框架相关错误。
- 执行 `npm run lint`，消除错误（警告可保留）。
- 若构建失败，回到第三步修复，不进入提交。

**出口条件**：`npm run build` 与 `npm run lint` 均通过，无 TS 错误。

### 第六步：提交与文档
- 更新 `TASKS.md`：将已完成项移至「已完成」并注明日期，勾选子任务。
- 更新 `CHANGELOG.md`：在当前版本或 Unreleased 下增加条目，简述新增/变更/修复，标注破坏性变更。
- 按约定式提交（Conventional Commits）分段提交，保持每次提交原子化。

约定式提交格式示例：`<type>(<scope>): <subject>`，type 如：feat, fix, docs, style, refactor, perf, test, chore。

**出口条件**：TASKS.md、CHANGELOG.md 已更新，提交信息规范，可进行下一项功能。

## 原则摘要

- **验收标准先行**：先定义「完成」再写代码。
- **组件进风格指南**：新 UI 组件先在风格指南/示例中落地并展示全部状态。
- **边做边测**：每步在浏览器中验证，不堆到最后一刻。
- **简单优先**：用满足验收标准的最简实现，避免过度设计。
- **循环回溯**：出问题回到对应阶段修正，不贴补丁。

## 输出约定

阶段结束时向用户简要说明：当前阶段结论、出口条件达成情况、下一步计划。全部完成后给出本次功能的总结与提交信息摘要（便于用户复制粘贴）。
